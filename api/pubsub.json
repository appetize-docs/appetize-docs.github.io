{"openapi":"3.0.0","info":{"version":"1.1.0","title":"Appetize PubSub","description":" <p>PubSub is our tool to let you know when something interesting happens in your account. When an interesting event occurs, we create a new Event object.Then we send this event according the subscription you have created.</p> <p>Pubsub has two methods: <strong>Create Subscription</strong> and <strong>Subscribe</strong>. To receive messages published to a topic, you must Subscribe to it using the subscritpionID. Only messages published to the topic after the subscription is created are available to subscriber applications.</p> <p><strong>Subscribe&nbsp;</strong>method is a gRPC stream, which means that you need to keep an open connection every time you want to receive messages.</p> <p>NOTE: We will provide you the following information, so you can connect to our services: <strong>gRPC host&nbsp;</strong>, <strong>API URL&nbsp;</strong></p> <h2>How does it works ?</h2> <p>We have two different implementations: Single tenant and multi tenant. In the single tenant the client subscribes to a topic only using the topicName. In the multi tenant, the client needs to create a subscription (using filters) and then use the subscriptionID to receive messages. The following diagram shows how they differ: </p> <h3>Single tenant:</h3> <p>Steps to receive events from one topic:</p> <p>1. Authenticate using Auth endpoint. It will return a JWT token.</p> <p>2. Subscribe to a topic using the following gRPC method: <pre> <code class=\"language-javascript\"> syntax = \"proto3\";<br>\npackage pubsub_subscriber.v1;<br>\nmessage SubscribeRequest {<br> string topic = 1;<br> }<br>\nmessage SubscribeResponse {<br> string id     = 1;<br> string type   = 3; <br> string action = 5;<br> uint32 timestamp = 7;<br> string resource_url = 9;<br> }<br>\nservice SubscriberService {<br> rpc Subscribe( SubscribeRequest) returns (stream SubscribeResponse){}<br> }<br> </code> </pre> <h3>Multi tenant:</h3> <p>Steps to receive events from one topic:</p> <p>1. Authenticate using Auth endpoint. It will return a JWT token.</p> <p>2. Create a subscription calling CreateNewSubscription. This needs to be done only once.</p> <p>3. Subscribe calling Subscribe gRPC method. You must use the subscriptionID returned in step 2:</p> <pre> <code class=\"language-javascript\"> syntax = \"proto3\";<br>\npackage pubsub_subscriber.v1;<br>\nmessage SubscribeRequest {<br> string subscription_id = 3;<br> }<br>\nmessage SubscribeResponse {<br> string id     = 1;<br> string type   = 3; <br> string action = 5;<br> uint32 timestamp = 7;<br> string resource_url = 9;<br> }<br>\nservice SubscriberService {<br> rpc Subscribe( SubscribeRequest) returns (stream SubscribeResponse){}<br> }<br> </code> </pre> <p>&nbsp;</p>\n","contact":{}},"servers":[{"description":"Appetize API URL. This URL will be provided by our team.","url":"https://{environment}.appetize.com"}],"paths":{"/auth/pubsub":{"post":{"summary":"Authentication of api key.","tags":["Auth"],"description":"This auth endpoint will return the JWT token required to call PubSub.","parameters":[{"$ref":"#/components/parameters/x_api_key"}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string","example":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ2MSI6eyJ0eXBlIjoidmlzaXRvciIsImNsYWltcyI6eyJkb21haW5JZCI6IjV"}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"bad request"},"code":{"type":"integer","example":400}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"unauthorized"},"code":{"type":"integer","example":401}}}}}}}}},"/pubsub-subscriber/subscriptions":{"post":{"summary":"Create subscription.","tags":["Create subscription"],"description":"This endpoint will return the SubscriptionID used to subscribe to a topic.","parameters":[{"$ref":"#/components/parameters/jwt_token"}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"1bc9efe3-c7bb-4fa1-81ff-6602d36883d1"}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"bad request"},"code":{"type":"integer","example":400}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"unauthorized"},"code":{"type":"integer","example":401}}}}}}}}},"/pubsub-subscriber/subscriptions/list":{"post":{"summary":"List subscriptions.","tags":["List subscriptions"],"description":"This endpoint will return the list of subscriptions.","parameters":[{"$ref":"#/components/parameters/jwt_token"}],"requestBody":{"description":"List Subscriptions Request","content":{"application/json":{"schema":{"type":"object","properties":{"filters":{"type":"object","properties":{"corporates":{"type":"array","items":{"type":"string","example":783}},"venues":{"type":"array","items":{"type":"string","example":2368}},"vendors":{"type":"array","items":{"type":"string","example":2368}}}},"pagination":{"type":"object","properties":{"page":{"type":"integer","format":"int32","example":0},"per_page":{"type":"integer","format":"int32","example":10}}}}}}}},"responses":{"200":{"description":"OK"},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"bad request"},"code":{"type":"integer","example":400}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"unauthorized"},"code":{"type":"integer","example":401}}}}}}}}}},"components":{"parameters":{"x_api_key":{"name":"X-API-Key","in":"header","required":true,"schema":{"type":"string"}},"jwt_token":{"name":"Authorization","in":"header","required":true,"schema":{"type":"string","example":"bearer eyJ0eXAiOi.."}}}},"x-readme":{"explorer-enabled":true,"proxy-enabled":true,"samples-enabled":true}}